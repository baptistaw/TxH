# ==============================================================================
# VARIABLES DE ENTORNO - Backend Sistema Registro TxH
# ==============================================================================
#
# INSTRUCCIONES:
# 1. Copiar este archivo a .env en la misma carpeta:
#    En Windows: copy .env.example .env
#    En Linux/Mac: cp .env.example .env
#
# 2. Reemplazar los valores de ejemplo con tus credenciales reales
#
# 3. NUNCA commitear el archivo .env al repositorio (ya está en .gitignore)
#
# ==============================================================================

# ------------------------------------------------------------------------------
# BASE DE DATOS POSTGRESQL
# ------------------------------------------------------------------------------

# URL de conexión a PostgreSQL
# Formato: postgresql://USUARIO:PASSWORD@HOST:PUERTO/NOMBRE_DB?schema=public

# Opción 1: PostgreSQL local (desarrollo)
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/txh_registro?schema=public"

# Opción 2: PostgreSQL en Railway.app (recomendado para staging/producción)
# DATABASE_URL="postgresql://postgres:PASSWORD@containers-us-west-XXX.railway.app:PUERTO/railway"

# Opción 3: Neon.tech (PostgreSQL serverless)
# DATABASE_URL="postgresql://USER:PASSWORD@ep-XXX.us-east-2.aws.neon.tech/neondb?sslmode=require"

# Opción 4: Azure Database for PostgreSQL
# DATABASE_URL="postgresql://USER@SERVIDOR:PASSWORD@SERVIDOR.postgres.database.azure.com:5432/txh_registro?sslmode=require"

# ------------------------------------------------------------------------------
# SERVIDOR
# ------------------------------------------------------------------------------

# Puerto en el que corre el servidor Express
PORT=4000

# Entorno: development, staging, production
NODE_ENV=development

# ------------------------------------------------------------------------------
# CLERK AUTHENTICATION
# ------------------------------------------------------------------------------

# Clerk Publishable Key (del dashboard de Clerk)
CLERK_PUBLISHABLE_KEY=pk_test_...

# Clerk Secret Key (del dashboard de Clerk)
CLERK_SECRET_KEY=sk_test_...

# Clerk Webhook Secret para verificar firma de webhooks
# Configurar en: Clerk Dashboard > Webhooks > Signing Secret
# Formato: whsec_xxxxxxxxxxxxx
CLERK_WEBHOOK_SECRET=whsec_...

# ------------------------------------------------------------------------------
# SEGURIDAD
# ------------------------------------------------------------------------------

# Secreto para firmar JWT (generar con: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))")
JWT_SECRET=REEMPLAZAR_CON_UN_STRING_ALEATORIO_LARGO_Y_SEGURO

# Tiempo de expiración del token JWT
JWT_EXPIRES_IN=7d

# Clave de cifrado para CI y datos sensibles (AES-256)
ENCRYPTION_KEY=REEMPLAZAR_CON_OTRA_CLAVE_ALEATORIA_DE_32_BYTES

# ------------------------------------------------------------------------------
# CORS (orígenes permitidos)
# ------------------------------------------------------------------------------

# Frontend en desarrollo
CORS_ORIGIN=http://localhost:3000

# En producción, cambiar a:
# CORS_ORIGIN=https://anestrasplante.org

# ------------------------------------------------------------------------------
# ALMACENAMIENTO DE ARCHIVOS (S3 compatible)
# ------------------------------------------------------------------------------

# AWS S3 o compatible (MinIO, Backblaze B2, Wasabi, etc.)
# Dejar en blanco si no se usará almacenamiento de archivos en MVP

S3_ENDPOINT=
S3_REGION=us-east-1
S3_BUCKET=txh-attachments
S3_ACCESS_KEY_ID=
S3_SECRET_ACCESS_KEY=

# ------------------------------------------------------------------------------
# LOGS Y MONITOREO
# ------------------------------------------------------------------------------

# Sentry DSN para tracking de errores (opcional)
SENTRY_DSN=

# Nivel de log: error, warn, info, debug
LOG_LEVEL=info

# ------------------------------------------------------------------------------
# EMAIL (opcional, para notificaciones)
# ------------------------------------------------------------------------------

# SMTP para envío de emails (ej: Gmail, SendGrid, Mailgun)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@txh-registro.uy

# ------------------------------------------------------------------------------
# RATE LIMITING (seguridad)
# ------------------------------------------------------------------------------

# Máximo de requests por IP por ventana de tiempo
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=900000  # 15 minutos

# ------------------------------------------------------------------------------
# ETL (EXTRACCIÓN, TRANSFORMACIÓN Y CARGA)
# ------------------------------------------------------------------------------

# Schedule de ETL incremental en formato cron
# Ejemplos:
#   0 */6 * * *   → Cada 6 horas (00:00, 06:00, 12:00, 18:00)
#   0 */12 * * *  → Cada 12 horas (00:00, 12:00)
#   0 2 * * *     → Diariamente a las 2:00 AM
#   */30 * * * *  → Cada 30 minutos
ETL_CRON_SCHEDULE=0 */12 * * *

# Ejecutar ETL al iniciar el scheduler (true/false)
ETL_RUN_ON_START=false

# ------------------------------------------------------------------------------
# OCR - GOOGLE CLOUD VISION (recomendado para producción)
# ------------------------------------------------------------------------------

# Habilitar Google Cloud Vision para OCR (true por defecto)
# Si está deshabilitado, usa Claude Vision (más caro)
USE_GOOGLE_VISION=true

# Opción 1: Ruta al archivo JSON de credenciales de servicio
# Descargar desde: Google Cloud Console > IAM > Service Accounts > Keys
GOOGLE_APPLICATION_CREDENTIALS=/ruta/a/tu/service-account-key.json

# Opción 2: Credenciales como JSON string (útil para Docker/Railway)
# Copiar todo el contenido del archivo JSON aquí (sin espacios ni saltos de línea)
# GOOGLE_CLOUD_CREDENTIALS={"type":"service_account","project_id":"tu-proyecto",...}

# Nota: Solo necesitas configurar UNA de las dos opciones anteriores.
# Si ambas están configuradas, se usa GOOGLE_CLOUD_CREDENTIALS.

# ------------------------------------------------------------------------------
# OCR - GOOGLE GEMINI (interpretación de texto)
# ------------------------------------------------------------------------------

# API Key de Google AI Studio para Gemini
# Obtener en: https://aistudio.google.com/app/apikey
GOOGLE_AI_API_KEY=AIzaSy...

# Modelo de Gemini (gemini-2.5-flash es rápido y económico)
GEMINI_MODEL=gemini-2.5-flash

# ------------------------------------------------------------------------------
# MISCELÁNEOS
# ------------------------------------------------------------------------------

# Zona horaria del sistema (para logs y timestamps)
TZ=America/Montevideo
